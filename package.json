{
  "name": "hxm-ai-analyzer-panel",
  "displayName": "Code Insight Panel",
  "description": "Real-time customizable AI code analysis panel",
  "version": "0.0.4",
  "publisher": "huanxiaomang",
  "license": "MIT",
  "engines": {
    "vscode": "^1.80.0"
  },
  "icon": "res/icon.png",
  "repository": {
    "type": "git",
    "url": "https://github.com/huanxiaomang/vscode-ai-anaylsis-panel"
  },
  "categories": [
    "Other"
  ],
  "activationEvents": [
    "onCommand:aiAnalyze.openPreview",
    "onStartupFinished"
  ],
  "main": "./out/extension.js",
  "contributes": {
    "commands": [
      {
        "command": "aiAnalyze.openPreview",
        "title": "启动AI分析视图"
      }
    ],
    "menus": {
      "explorer/context": [
        {
          "command": "aiAnalyze.openPreview",
          "group": "navigation",
          "title": "启动 AI 分析视图"
        }
      ]
    },
    "configuration": {
      "title": "AI Code Analyzer Panel",
      "properties": {
        "aiAnalyze.apiKey": {
          "type": "string",
          "default": "",
          "description": "API Key"
        },
        "aiAnalyze.apiEndpoint": {
          "type": "string",
          "default": "https://api.openai.com/v1/chat/completions",
          "description": "API Endpoint"
        },
        "aiAnalyze.model": {
          "type": "string",
          "default": "gpt-4o-mini",
          "description": "Model name"
        },
        "aiAnalyze.maxParallelRequests": {
          "type": "number",
          "default": 30,
          "description": "Maximum number of parallel AI requests"
        },
        "aiAnalyze.tabs": {
          "type": "array",
          "default": [
            {
              "key": "summary",
              "title": "内容概览",
              "prompt": "你是一位拥有 10 年以上经验的资深程序员 Leader，正在给新加入项目的成员做代码讲解。\\n文件名称：${fileName}\\n代码内容：\\n```\\n${codeContent}\\n```\\n你是一位专业的产品经理，请用 Markdown 格式输出以下两部分：\\n### 1. 文件整体定位（50-80 字）\\n几句话说明这个文件在整个项目中的角色和核心职责。\\n### 2. 主要功能点\\n- 用通俗、产品化的语言描述这个文件“对外提供了什么能力”\\n- 只能少量出现“实现细节”“具体算法”“变量名”“行号”等技术细节的东西\\n- 像写**需求文档**一样专业完善客观，毫无遗漏地罗列所有功能点，每个功能点有简明扼要的标题也有根据代码转换过来的详细描述，不可遗漏\\n- 因为功能点可能内容很多，所以使用列表或表格体现，并且善用分组、标题、小标题等手段去归类和划分核心和不核心的内容，让文档结构清晰，内容条理分明\\n要求：\\n- **重点** 理性客观，不夸大，不要像广告或营销号一样堆形容词，你的职责只有描述功能。\\n- 语言必须让非本文件作者的开发者 1 分钟内看懂\\n- 绝对不许出现“努力”“优化”“处理”等模糊词\\n- 如果文件是工具类/配置类/测试文件，必须在第一句话明确点出"
            },
            {
              "key": "implementation",
              "title": "核心实现",
              "prompt": "你是一位技术极深的程序员 Leader，正在给团队做 Code Review 和技术分享。\\n文件名称：${fileName}\\n代码内容：\\n```\\n${codeContent}\\n```\\n请用 Markdown 格式撰写《实现细节分析》，必须包含以下章节：\\n### 核心职责与定位（简述，100 字以内）\\n### 整体执行流程（用序号或流程图描述主路径）\\n### 关键模块/方法拆解（按重要性排序，每部分说明职责与输入输出）\\n### 重要技术点与实现技巧（包括但不限于：状态管理、错误处理、性能考虑、设计模式、边界处理等）\\n### 潜在风险点简要提示\\n要求：\\n- 所有解释必须基于代码实际内容，不能臆想\\n- 术语使用精准，结构层次清晰，善用表格清除罗列内容\\n- 每小节开头用一句话总结该部分核心结论"
            },
            {
              "key": "optimization",
              "title": "优化建议",
              "prompt": "你是一位极其挑剔但又极具建设性的资深程序员 Leader，正在对 ${fileName} 进行正式 Code Review。\\n代码内容：\\n```\\n${codeContent}\\n```\\n请用 Markdown 输出《优化建议报告》，必须包含以下三大板块：\\n### 一、主要问题（按严重程度排序，每条单独列出）\\n- 每条格式：【严重/中/轻】问题描述 + 具体位置（行号或函数名）+ 为什么是问题+xxx（自行发挥）\\n### 二、优化建议（必须一一对应上面的问题）\\n- 每条给出具体、可落地的重构方案或改进代码示例\\n- 如果涉及重构模式，要写出模式名称\\n### 要求：\\n- 必须有具体行号或函数名作为定位\\n- 不能泛泛而谈“建议优化”“可读性差”\\n- 如果代码整体优秀，可以大幅减少“主要问题”部分，\\n- 语气专业且友善，不允许嘲讽或情绪化语言"
            },
            {
              "key": "fasan",
              "title": "发散模式",
              "prompt": "发散模式：没有足够知识网络的初学者很容易像无头苍蝇一样没有明确清晰的路径建立提示词去从ai获取知识，路径可能是偏的，而你将扮演一个资深的工程师，我问哪方面问题是你可以不光回答答案还可以洞察我的背后需求以及我应该需要的但是我自己不知道的，所以你的详细核心回答应该沿着主流线路前进，同时要简略但不能缺少关键词地补充上“支线”：比如我问你dts生成方案，那么主流就是使用unplugin-dts、vite-plugin-dts，不过以你的经验和洞察我的需求可知，你还要在下面简要提及elementplus使用命令行+API Extractor的策略，遵从“关键词优先”原则（回复字数有限时，精简语言，用符号和关键词简要表达）同时如果搜索到了非“主流”的文章或者不是非常简单基础的使用教程或经验、问题分析的文章也要贴上去，这都是为了把ai问答流从线性发散成网状，让用户更快更全面地了解。我会给你代码，你要按照发散模式尽可能地多涉及相关知识点地去讲解分析。${fileName} ${codeContent}"
            },
            {
              "key": "mianshi",
              "title": "面试考点",
              "prompt": "生成这些代码包含的知识点和实现手段，分析对应的面试题，先写出对应考点，然后再提出对应面试问题，要全面深入考察${fileName} ${codeContent}"
            },
            {
              "key": "fuckshit",
              "title": "屎山检测",
              "prompt": "你是一位极其挑剔但又极具建设性的资深程序员，有的项目代码可能经过了长久的、多人包括AI参与的大量长期迭代，其内部状态流转逻辑、函数封装可能混乱不堪、完全不统一，这种项目再迭代可能出错的概率会大大增加。你致力于分析代码整体，找到整体上的可重构、可统一的点，详细提出对应的优化建议，需要写代码时要输出必要的示例代码${fileName} ${codeContent}"
            }
          ],
          "description": "自定义分析维度，支持任意数量",
          "items": {
            "type": "object",
            "required": [
              "key",
              "title",
              "prompt"
            ],
            "properties": {
              "key": {
                "type": "string"
              },
              "title": {
                "type": "string"
              },
              "prompt": {
                "type": "string"
              },
              "disable": {
                "type": "boolean"
              }
            }
          }
        }
      }
    }
  },
  "scripts": {
    "compile": "tsdown",
    "watch": "tsdown --watch"
  },
  "devDependencies": {
    "@types/node": "18.x",
    "@types/vscode": "^1.80.0",
    "tsdown": "^0.16.8",
    "typescript": "^5.1.3"
  }
}
